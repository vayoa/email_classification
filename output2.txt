❯ uv run train_email_multitask.py  --csv ./email_dataset.csv  --text-col text  --max-length 512  --batch-size 16  --epochs 3
The tokenizer has new PAD/BOS/EOS tokens that differ from the model config and generation config. The model config and generation config were aligned accordingly, being updated with the tokenizer's values. Updated tokens: {'eos_token_id': None, 'bos_token_id': None}.
{'loss': 2.5673, 'grad_norm': 17.108139038085938, 'learning_rate': 1.6296296296296297e-05, 'epoch': 0.14}
{'loss': 0.9807, 'grad_norm': 16.88939666748047, 'learning_rate': 1.9215686274509807e-05, 'epoch': 0.28}
{'loss': 0.3244, 'grad_norm': 15.009876251220703, 'learning_rate': 1.823529411764706e-05, 'epoch': 0.42}
{'loss': 0.2713, 'grad_norm': 9.170948028564453, 'learning_rate': 1.7254901960784314e-05, 'epoch': 0.56}
{'loss': 0.1417, 'grad_norm': 2.9351813793182373, 'learning_rate': 1.627450980392157e-05, 'epoch': 0.7}
{'loss': 0.1569, 'grad_norm': 9.178803443908691, 'learning_rate': 1.5294117647058822e-05, 'epoch': 0.84}
{'loss': 0.1032, 'grad_norm': 3.369297981262207, 'learning_rate': 1.431372549019608e-05, 'epoch': 0.98}
{'eval_loss': 0.09406484663486481, 'eval_overall_score': 0.979642971508955, 'eval_cat_accuracy': 0.9866468842729971, 'eval_cat_macro_f1': 0.9866207949541285, 'eval_cat_weighted_f1': 0.9866297512695744, 'eval_cat_macro_precision': 0.9866991852844467, 'eval_cat_macro_recall': 0.9866379918808018, 'eval_imp_accuracy': 0.9881305637982196, 'eval_imp_precision': 0.9682539682539683, 'eval_imp_recall': 0.977116704805492, 'eval_imp_f1': 0.9726651480637813, 'eval_imp_roc_auc': 0.9978084011290055, 'eval_runtime': 19.0059, 'eval_samples_per_second': 106.388, 'eval_steps_per_second': 13.312, 'epoch': 1.0}
{'loss': 0.0519, 'grad_norm': 6.636658668518066, 'learning_rate': 1.3333333333333333e-05, 'epoch': 1.12}
{'loss': 0.0479, 'grad_norm': 2.397930145263672, 'learning_rate': 1.235294117647059e-05, 'epoch': 1.26}
{'loss': 0.0608, 'grad_norm': 1.650230884552002, 'learning_rate': 1.1411764705882353e-05, 'epoch': 1.4}
{'loss': 0.034, 'grad_norm': 4.127962589263916, 'learning_rate': 1.0431372549019609e-05, 'epoch': 1.54}                                                                                                                                                                                                                                                    
{'loss': 0.0299, 'grad_norm': 1.8183492422103882, 'learning_rate': 9.450980392156863e-06, 'epoch': 1.68}                                                                                                                                                                                                                                                   
{'loss': 0.0476, 'grad_norm': 0.8876307606697083, 'learning_rate': 8.470588235294118e-06, 'epoch': 1.82}                                                                                                                                                                                                                                                   
{'loss': 0.0325, 'grad_norm': 1.2791743278503418, 'learning_rate': 7.490196078431373e-06, 'epoch': 1.96}                                                                                                                                                                                                                                                   
{'eval_loss': 0.042732421308755875, 'eval_overall_score': 0.9927528593738933, 'eval_cat_accuracy': 0.993570722057369, 'eval_cat_macro_f1': 0.9935609546511238, 'eval_cat_weighted_f1': 0.9935661337276122, 'eval_cat_macro_precision': 0.9936038562292873, 'eval_cat_macro_recall': 0.9935648257307125, 'eval_imp_accuracy': 0.996538081107814, 'eval_imp_precision': 0.9976851851851852, 'eval_imp_recall': 0.9862700228832952, 'eval_imp_f1': 0.9919447640966629, 'eval_imp_roc_auc': 0.9996578333778486, 'eval_runtime': 19.9569, 'eval_samples_per_second': 101.318, 'eval_steps_per_second': 12.677, 'epoch': 2.0}                                                                                               
{'loss': 0.025, 'grad_norm': 0.1270267516374588, 'learning_rate': 6.5098039215686285e-06, 'epoch': 2.09}                                                                                                                                                                                                                                                   
{'loss': 0.0046, 'grad_norm': 0.5088638067245483, 'learning_rate': 5.529411764705883e-06, 'epoch': 2.23}
{'loss': 0.0072, 'grad_norm': 0.170084610581398, 'learning_rate': 4.549019607843138e-06, 'epoch': 2.37}                                                                                                                                                                                                                                                    
{'loss': 0.0042, 'grad_norm': 0.043783754110336304, 'learning_rate': 3.5686274509803926e-06, 'epoch': 2.51}                                                                                                                                                                                                                                                
{'loss': 0.0114, 'grad_norm': 0.034240324050188065, 'learning_rate': 2.5882352941176473e-06, 'epoch': 2.65}                                                                                                                                                                                                                                                
{'loss': 0.0055, 'grad_norm': 0.4616091847419739, 'learning_rate': 1.6078431372549023e-06, 'epoch': 2.79}                                                                                                                                                                                                                                                  
{'loss': 0.0141, 'grad_norm': 0.5268130302429199, 'learning_rate': 6.274509803921569e-07, 'epoch': 2.93}                                                                                                                                                                                                                                                   
{'eval_loss': 0.0449562668800354, 'eval_overall_score': 0.9924179912316603, 'eval_cat_accuracy': 0.9940652818991098, 'eval_cat_macro_f1': 0.9940525723250717, 'eval_cat_weighted_f1': 0.9940570384865063, 'eval_cat_macro_precision': 0.9940853471146428, 'eval_cat_macro_recall': 0.9940593768629604, 'eval_imp_accuracy': 0.9960435212660732, 'eval_imp_precision': 0.9976798143851509, 'eval_imp_recall': 0.9839816933638444, 'eval_imp_f1': 0.9907834101382489, 'eval_imp_roc_auc': 0.9997993199979787, 'eval_runtime': 20.209, 'eval_samples_per_second': 100.055, 'eval_steps_per_second': 12.519, 'epoch': 3.0}                                                                                                
{'train_runtime': 1380.1391, 'train_samples_per_second': 24.9, 'train_steps_per_second': 0.389, 'train_loss': 0.22926659784947473, 'epoch': 3.0}                                                                                                                                                                                                           
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 537/537 [23:00<00:00,  2.57s/it]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 253/253 [00:19<00:00, 12.79it/s]
{
  "output_dir": "outputs/modernbert_multitask",
  "eval_loss": 0.042732421308755875,
  "eval_overall_score": 0.9927528593738933,
  "eval_cat_accuracy": 0.993570722057369,
  "eval_cat_macro_f1": 0.9935609546511238,
  "eval_cat_weighted_f1": 0.9935661337276122,
  "eval_cat_macro_precision": 0.9936038562292873,
  "eval_cat_macro_recall": 0.9935648257307125,
  "eval_imp_accuracy": 0.996538081107814,
  "eval_imp_precision": 0.9976851851851852,
  "eval_imp_recall": 0.9862700228832952,
  "eval_imp_f1": 0.9919447640966629,
  "eval_imp_roc_auc": 0.9996578333778486,
  "eval_runtime": 20.0283,
  "eval_samples_per_second": 100.957,
  "eval_steps_per_second": 12.632,
  "epoch": 3.0
}